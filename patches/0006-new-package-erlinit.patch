From 11f727b51193d51517585199cc805269d0767a53 Mon Sep 17 00:00:00 2001
From: Frank Hunleth <fhunleth@troodon-software.com>
Date: Tue, 29 Oct 2013 14:56:21 -0400
Subject: [PATCH 6/9] new package: erlinit

---
 package/Config.in          |  1 +
 package/erlinit/Config.in  |  7 +++++++
 package/erlinit/erlinit.mk | 25 +++++++++++++++++++++++++
 3 files changed, 33 insertions(+)
 create mode 100644 package/erlinit/Config.in
 create mode 100644 package/erlinit/erlinit.mk

diff --git a/package/Config.in b/package/Config.in
index 519c0e5..051ed22 100644
--- a/package/Config.in
+++ b/package/Config.in
@@ -353,6 +353,7 @@ endmenu
 menu "Interpreter languages and scripting"
 source "package/enscript/Config.in"
 source "package/erlang/Config.in"
+source "package/erlinit/Config.in"
 source "package/haserl/Config.in"
 source "package/jamvm/Config.in"
 source "package/jimtcl/Config.in"
diff --git a/package/erlinit/Config.in b/package/erlinit/Config.in
new file mode 100644
index 0000000..d9b6673
--- /dev/null
+++ b/package/erlinit/Config.in
@@ -0,0 +1,7 @@
+config BR2_PACKAGE_ERLINIT
+	bool "erlinit"
+	depends on BR2_PACKAGE_ERLANG
+	help
+	  Erlinit is a replacement for /sbin/init that starts erlang.
+
+	  https://github.com/fhunleth/erlinit
diff --git a/package/erlinit/erlinit.mk b/package/erlinit/erlinit.mk
new file mode 100644
index 0000000..eabd2ac
--- /dev/null
+++ b/package/erlinit/erlinit.mk
@@ -0,0 +1,25 @@
+#############################################################
+#
+# erlinit
+#
+#############################################################
+
+ERLINIT_VERSION = 1ea141cc37df23595abda4d3123e01c832543d1f
+ERLINIT_SITE = $(call github,nerves-project,erlinit,$(ERLINIT_VERSION))
+ERLINIT_LICENSE = MIT
+
+# Make sure erlinit gets installed after busybox init so that
+# it gets called
+ifeq ($(BR2_PACKAGE_BUSYBOX),y)
+ERLINIT_DEPENDENCIES += busybox
+endif
+
+define ERLINIT_BUILD_CMDS
+	$(MAKE1) $(TARGET_CONFIGURE_OPTS) -C $(@D)
+endef
+
+define ERLINIT_INSTALL_TARGET_CMDS
+	$(INSTALL) -D -m 755 $(@D)/erlinit $(TARGET_DIR)/sbin/init
+endef
+
+$(eval $(generic-package))
-- 
1.8.3.2

